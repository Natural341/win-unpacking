(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26125,e=>{"use strict";var t=e.i(68675),a=e.i(51797),s=e.i(68621),r=e.i(98319);function l(){let e,l,i,d,o,n,c=(0,s.useTranslations)("common"),[x,m]=(0,a.useState)(null),[g,h]=(0,a.useState)([]),[p,b]=(0,a.useState)([]),[y,u]=(0,a.useState)(!0),[f,j]=(0,a.useState)(!1),[N,v]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[S,C]=(0,a.useState)(0),[T,F]=(0,a.useState)(0),[K,A]=(0,a.useState)({type:"income",category:"",amount:0,description:""});(0,a.useEffect)(()=>{E(),R()},[]);let E=async()=>{try{let e=await fetch("/api/cash-register?active=true");if(!e.ok)throw Error("Failed to fetch");let t=await e.json();m(t.data),h(t.data?.transactions||[])}catch(e){console.error("Error fetching register:",e)}finally{u(!1)}},R=async()=>{try{let e=new Date().toISOString().split("T")[0],t=await fetch(`/api/sales?date=${e}`);if(!t.ok)throw Error("Failed to fetch");let a=await t.json();b(a.sales||[])}catch(e){console.error("Error fetching sales:",e)}},O=async()=>{try{let e=await fetch("/api/cash-register/open",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({openingCash:S})});if(!e.ok){let t=await e.json();alert(t.error||"İşlem başarısız");return}j(!1),C(0),E()}catch(e){console.error("Error opening register:",e),alert("Hata oluştu")}},z=async()=>{try{let e=await fetch("/api/cash-register/close",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({closingCash:T})});if(!e.ok){let t=await e.json();alert(t.error||"İşlem başarısız");return}let t=await e.json();alert(`Kasa kapatıldı. Z Rapor No: ${t.zReportNumber}`),v(!1),F(0),E()}catch(e){console.error("Error closing register:",e),alert("Hata oluştu")}},D=async e=>{if(e.preventDefault(),!x)return void alert("Kasa açık değil");try{let e=await fetch("/api/cash-register/transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...K,cashRegisterId:x.id})});if(!e.ok){let t=await e.json();alert(t.error||"İşlem başarısız");return}k(!1),B(),E()}catch(e){console.error("Error adding transaction:",e),alert("Hata oluştu")}},B=()=>{A({type:"income",category:"",amount:0,description:""})},H=(e=p.reduce((e,t)=>e+t.finalAmount,0),l=p.filter(e=>"cash"===e.paymentMethod).reduce((e,t)=>e+t.finalAmount,0),i=p.filter(e=>"creditCard"===e.paymentMethod).reduce((e,t)=>e+t.finalAmount,0),d=g.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),o=g.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),n=(x?.openingCash||0)+l+d-o,{totalSales:e,totalCashSales:l,totalCardSales:i,totalIncome:d,totalExpense:o,expectedCash:n,salesCount:p.length});return y?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("div",{className:"text-xl font-semibold text-gray-600",children:c("loading")})})}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"sm:flex sm:items-center sm:justify-between mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-950 tracking-tight",children:"Kasa Yönetimi"}),(0,t.jsx)("div",{className:"flex gap-3 mt-4 sm:mt-0",children:(0,t.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold shadow-sm hover:shadow-md transition-all duration-150 tracking-tight",children:[(0,t.jsx)(r.BanknotesIcon,{className:"h-5 w-5"}),"Tahsilat/Ödeme"]})})]}),(0,t.jsx)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100 mb-6",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-950 mb-2",children:"Kasa Durumu"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-black text-white",children:"AÇIK"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:x?.openedAt?new Date(x.openedAt).toLocaleString("tr-TR"):new Date().toLocaleString("tr-TR")})]}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-gray-950",children:["Açılış: ₺",(x?.openingCash||0).toFixed(2)]})]})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Toplam Satış"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",H.totalSales.toFixed(2)]}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[H.salesCount," işlem"]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Nakit Satış"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",H.totalCashSales.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Kart Satış"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",H.totalCardSales.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Beklenen Nakit"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",H.expectedCash.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden border border-gray-100",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-950",children:"Bugünkü Hareketler"})}),(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tarih"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tip"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Kategori"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Açıklama"}),(0,t.jsx)("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tutar"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:0===g.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:5,className:"px-6 py-6 text-center text-gray-500 font-medium tracking-tight",children:"Henüz işlem yok"})}):g.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-100",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-700",children:new Date(e.createdAt).toLocaleTimeString("tr-TR")}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:"income"===e.type?(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-black text-white",children:"GELİR"}):"expense"===e.type?(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-700 text-white",children:"GİDER"}):(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800",children:e.type.toUpperCase()})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-700",children:e.category||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.description||"-"}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-950",children:["income"===e.type?"+":"-","₺",e.amount.toFixed(2)]})]},e.id))})]})]}),f&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Kasa Aç"})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Açılış Nakit Miktarı (₺)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:S,onChange:e=>C(parseFloat(e.target.value)||0),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",autoFocus:!0})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{onClick:O,className:"flex-1 px-4 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kasa Aç"}),(0,t.jsx)("button",{onClick:()=>{j(!1),C(0)},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})}),N&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Kasa Kapat"})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Beklenen Nakit:"}),(0,t.jsxs)("span",{className:"font-bold text-gray-950",children:["₺",H.expectedCash.toFixed(2)]})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Sayılan Nakit Miktarı (₺)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:T,onChange:e=>F(parseFloat(e.target.value)||0),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",autoFocus:!0})]}),T>0&&(0,t.jsx)("div",{className:`p-3 rounded-lg ${.01>Math.abs(T-H.expectedCash)?"bg-gray-100":"bg-gray-200"}`,children:(0,t.jsxs)("div",{className:"text-sm font-bold text-gray-950",children:["Fark: ₺",(T-H.expectedCash).toFixed(2)]})}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{onClick:z,className:"flex-1 px-4 py-2.5 bg-gray-700 text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kapat & Z Rapor"}),(0,t.jsx)("button",{onClick:()=>{v(!1),F(0)},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})}),w&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Tahsilat/Ödeme Ekle"})}),(0,t.jsxs)("form",{onSubmit:D,className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"İşlem Tipi"}),(0,t.jsxs)("select",{value:K.type,onChange:e=>A({...K,type:e.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",children:[(0,t.jsx)("option",{value:"income",children:"Gelir (Tahsilat)"}),(0,t.jsx)("option",{value:"expense",children:"Gider (Ödeme)"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Kategori"}),(0,t.jsx)("input",{type:"text",value:K.category,onChange:e=>A({...K,category:e.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",placeholder:"örn: Kira, Fatura, vs."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Tutar (₺)"}),(0,t.jsx)("input",{type:"number",step:"0.01",required:!0,value:K.amount,onChange:e=>A({...K,amount:parseFloat(e.target.value)||0}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Açıklama"}),(0,t.jsx)("textarea",{value:K.description,onChange:e=>A({...K,description:e.target.value}),rows:2,className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kaydet"}),(0,t.jsx)("button",{type:"button",onClick:()=>{k(!1),B()},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})})]})}e.s(["default",()=>l])}]);