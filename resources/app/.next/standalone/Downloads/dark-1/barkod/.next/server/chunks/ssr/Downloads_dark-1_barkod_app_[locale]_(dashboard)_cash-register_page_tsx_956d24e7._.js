module.exports=[49278,a=>{"use strict";var b=a.i(19598),c=a.i(73151),d=a.i(17665),e=a.i(6432);function f(){let a,f,g,h,i,j,k=(0,d.useTranslations)("common"),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(0),[B,C]=(0,c.useState)(0),[D,E]=(0,c.useState)({type:"income",category:"",amount:0,description:""});(0,c.useEffect)(()=>{F(),G()},[]);let F=async()=>{try{let a=await fetch("/api/cash-register?active=true");if(!a.ok)throw Error("Failed to fetch");let b=await a.json();m(b.data),o(b.data?.transactions||[])}catch(a){console.error("Error fetching register:",a)}finally{s(!1)}},G=async()=>{try{let a=new Date().toISOString().split("T")[0],b=await fetch(`/api/sales?date=${a}`);if(!b.ok)throw Error("Failed to fetch");let c=await b.json();q(c.sales||[])}catch(a){console.error("Error fetching sales:",a)}},H=async()=>{try{let a=await fetch("/api/cash-register/open",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({openingCash:z})});if(!a.ok){let b=await a.json();alert(b.error||"İşlem başarısız");return}u(!1),A(0),F()}catch(a){console.error("Error opening register:",a),alert("Hata oluştu")}},I=async()=>{try{let a=await fetch("/api/cash-register/close",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({closingCash:B})});if(!a.ok){let b=await a.json();alert(b.error||"İşlem başarısız");return}let b=await a.json();alert(`Kasa kapatıldı. Z Rapor No: ${b.zReportNumber}`),w(!1),C(0),F()}catch(a){console.error("Error closing register:",a),alert("Hata oluştu")}},J=async a=>{if(a.preventDefault(),!l)return void alert("Kasa açık değil");try{let a=await fetch("/api/cash-register/transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...D,cashRegisterId:l.id})});if(!a.ok){let b=await a.json();alert(b.error||"İşlem başarısız");return}y(!1),K(),F()}catch(a){console.error("Error adding transaction:",a),alert("Hata oluştu")}},K=()=>{E({type:"income",category:"",amount:0,description:""})},L=(a=p.reduce((a,b)=>a+b.finalAmount,0),f=p.filter(a=>"cash"===a.paymentMethod).reduce((a,b)=>a+b.finalAmount,0),g=p.filter(a=>"creditCard"===a.paymentMethod).reduce((a,b)=>a+b.finalAmount,0),h=n.filter(a=>"income"===a.type).reduce((a,b)=>a+b.amount,0),i=n.filter(a=>"expense"===a.type).reduce((a,b)=>a+b.amount,0),j=(l?.openingCash||0)+f+h-i,{totalSales:a,totalCashSales:f,totalCardSales:g,totalIncome:h,totalExpense:i,expectedCash:j,salesCount:p.length});return r?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"text-xl font-semibold text-gray-600",children:k("loading")})})}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"sm:flex sm:items-center sm:justify-between mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-gray-950 tracking-tight",children:"Kasa Yönetimi"}),(0,b.jsx)("div",{className:"flex gap-3 mt-4 sm:mt-0",children:(0,b.jsxs)("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold shadow-sm hover:shadow-md transition-all duration-150 tracking-tight",children:[(0,b.jsx)(e.BanknotesIcon,{className:"h-5 w-5"}),"Tahsilat/Ödeme"]})})]}),(0,b.jsx)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100 mb-6",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-gray-950 mb-2",children:"Kasa Durumu"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-black text-white",children:"AÇIK"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:l?.openedAt?new Date(l.openedAt).toLocaleString("tr-TR"):new Date().toLocaleString("tr-TR")})]}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-950",children:["Açılış: ₺",(l?.openingCash||0).toFixed(2)]})]})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Toplam Satış"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",L.totalSales.toFixed(2)]}),(0,b.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[L.salesCount," işlem"]})]}),(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Nakit Satış"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",L.totalCashSales.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Kart Satış"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",L.totalCardSales.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-xl p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-gray-700 mb-2",children:"Beklenen Nakit"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-950",children:["₺",L.expectedCash.toFixed(2)]})]})]}),(0,b.jsxs)("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden border border-gray-100",children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-lg font-bold text-gray-950",children:"Bugünkü Hareketler"})}),(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tarih"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tip"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Kategori"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Açıklama"}),(0,b.jsx)("th",{className:"px-6 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wide",children:"Tutar"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:0===n.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:5,className:"px-6 py-6 text-center text-gray-500 font-medium tracking-tight",children:"Henüz işlem yok"})}):n.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-100",children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-700",children:new Date(a.createdAt).toLocaleTimeString("tr-TR")}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:"income"===a.type?(0,b.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-black text-white",children:"GELİR"}):"expense"===a.type?(0,b.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-700 text-white",children:"GİDER"}):(0,b.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800",children:a.type.toUpperCase()})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-700",children:a.category||"-"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:a.description||"-"}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-950",children:["income"===a.type?"+":"-","₺",a.amount.toFixed(2)]})]},a.id))})]})]}),t&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Kasa Aç"})}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Açılış Nakit Miktarı (₺)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:z,onChange:a=>A(parseFloat(a.target.value)||0),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",autoFocus:!0})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{onClick:H,className:"flex-1 px-4 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kasa Aç"}),(0,b.jsx)("button",{onClick:()=>{u(!1),A(0)},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})}),v&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Kasa Kapat"})}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700",children:"Beklenen Nakit:"}),(0,b.jsxs)("span",{className:"font-bold text-gray-950",children:["₺",L.expectedCash.toFixed(2)]})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Sayılan Nakit Miktarı (₺)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:B,onChange:a=>C(parseFloat(a.target.value)||0),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",autoFocus:!0})]}),B>0&&(0,b.jsx)("div",{className:`p-3 rounded-lg ${.01>Math.abs(B-L.expectedCash)?"bg-gray-100":"bg-gray-200"}`,children:(0,b.jsxs)("div",{className:"text-sm font-bold text-gray-950",children:["Fark: ₺",(B-L.expectedCash).toFixed(2)]})}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{onClick:I,className:"flex-1 px-4 py-2.5 bg-gray-700 text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kapat & Z Rapor"}),(0,b.jsx)("button",{onClick:()=>{w(!1),C(0)},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})}),x&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-950 tracking-tight",children:"Tahsilat/Ödeme Ekle"})}),(0,b.jsxs)("form",{onSubmit:J,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"İşlem Tipi"}),(0,b.jsxs)("select",{value:D.type,onChange:a=>E({...D,type:a.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",children:[(0,b.jsx)("option",{value:"income",children:"Gelir (Tahsilat)"}),(0,b.jsx)("option",{value:"expense",children:"Gider (Ödeme)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Kategori"}),(0,b.jsx)("input",{type:"text",value:D.category,onChange:a=>E({...D,category:a.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium",placeholder:"örn: Kira, Fatura, vs."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Tutar (₺)"}),(0,b.jsx)("input",{type:"number",step:"0.01",required:!0,value:D.amount,onChange:a=>E({...D,amount:parseFloat(a.target.value)||0}),className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Açıklama"}),(0,b.jsx)("textarea",{value:D.description,onChange:a=>E({...D,description:a.target.value}),rows:2,className:"w-full rounded-lg border-gray-300 focus:border-gray-900 focus:ring-gray-900 py-2 px-3 border font-medium"})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-black text-white rounded-lg hover:bg-gray-800 font-semibold",children:"Kaydet"}),(0,b.jsx)("button",{type:"button",onClick:()=>{y(!1),K()},className:"flex-1 px-4 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"İptal"})]})]})]})})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=Downloads_dark-1_barkod_app_%5Blocale%5D_%28dashboard%29_cash-register_page_tsx_956d24e7._.js.map