module.exports=[18622,(e,t,a)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,a)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,a)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},29173,(e,t,a)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},48221,e=>{"use strict";var t=e.i(29173);let a=e.g.prisma||new t.PrismaClient({log:["error"]});e.s(["prisma",0,a])},10370,e=>{"use strict";var t=e.i(38492),a=e.i(84872),r=e.i(70799),n=e.i(30338),s=e.i(81164),i=e.i(71848),o=e.i(7940),d=e.i(97514),c=e.i(63734),u=e.i(82872),l=e.i(62363),p=e.i(49641),m=e.i(29642),h=e.i(52927),f=e.i(39125),y=e.i(34218),x=e.i(93695);e.i(21457);var g=e.i(19079),A=e.i(31338),v=e.i(48221);async function w(){try{let[e,t,a,r,n,s,i,o,d]=await Promise.all([v.prisma.category.findMany({include:{products:!0}}),v.prisma.product.findMany({include:{category:!0,supplier:!0}}),v.prisma.sale.findMany({include:{items:{include:{product:!0}},customer:!0}}),v.prisma.stockMovement.findMany({include:{product:!0}}),v.prisma.return.findMany({include:{items:{include:{product:!0}},sale:!0,customer:!0}}),v.prisma.customer.findMany(),v.prisma.supplier.findMany({include:{products:!0}}),v.prisma.purchase.findMany({include:{items:{include:{product:!0}},supplier:!0}}),v.prisma.cashTransaction.findMany()]),c={exportDate:new Date().toISOString(),version:"2.0",data:{categories:e,products:t,sales:a,stockMovements:r,returns:n,customers:s,suppliers:i,purchases:o,cashTransactions:d},statistics:{totalCategories:e.length,totalProducts:t.length,totalSales:a.length,totalReturns:n.length,totalCustomers:s.length,totalSuppliers:i.length,totalPurchases:o.length,totalStockMovements:r.length,totalCashTransactions:d.length}},u=JSON.stringify(c,null,2);return new A.NextResponse(u,{headers:{"Content-Type":"application/json","Content-Disposition":`attachment; filename=backup-${new Date().toISOString().split("T")[0]}.json`}})}catch(e){return console.error("Error creating backup:",e),A.NextResponse.json({error:"Yedek oluşturulamadı"},{status:500})}}async function R(e){try{let t=await e.json();if(!t.version||!t.data)return A.NextResponse.json({error:"Geçersiz yedek dosyası formatı"},{status:400});let{data:a}=t;await v.prisma.$transaction([v.prisma.stockMovement.deleteMany(),v.prisma.saleItem.deleteMany(),v.prisma.returnItem.deleteMany(),v.prisma.purchaseItem.deleteMany(),v.prisma.return.deleteMany(),v.prisma.sale.deleteMany(),v.prisma.purchase.deleteMany(),v.prisma.cashTransaction.deleteMany(),v.prisma.product.deleteMany(),v.prisma.category.deleteMany(),v.prisma.customer.deleteMany(),v.prisma.supplier.deleteMany()]);let r={categories:0,suppliers:0,customers:0,products:0,sales:0,returns:0,purchases:0,stockMovements:0,cashTransactions:0};if(a.categories&&a.categories.length>0)for(let e of a.categories)await v.prisma.category.create({data:{id:e.id,name:e.name,description:e.description,isActive:e.isActive,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}),r.categories++;if(a.suppliers&&a.suppliers.length>0)for(let e of a.suppliers)await v.prisma.supplier.create({data:{id:e.id,code:e.code,name:e.name,contactPerson:e.contactPerson,phone:e.phone,email:e.email,address:e.address,taxNumber:e.taxNumber,taxOffice:e.taxOffice,paymentTerm:e.paymentTerm,currentBalance:e.currentBalance,isActive:e.isActive,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}),r.suppliers++;if(a.customers&&a.customers.length>0)for(let e of a.customers)await v.prisma.customer.create({data:{id:e.id,code:e.code,name:e.name,email:e.email,phone:e.phone,address:e.address,taxNumber:e.taxNumber,customerType:e.customerType,creditLimit:e.creditLimit,currentBalance:e.currentBalance,loyaltyPoints:e.loyaltyPoints,isActive:e.isActive,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}),r.customers++;if(a.products&&a.products.length>0)for(let e of a.products)await v.prisma.product.create({data:{id:e.id,barcode:e.barcode,name:e.name,description:e.description,categoryId:e.categoryId,supplierId:e.supplierId,price:e.price,costPrice:e.costPrice,stock:e.stock,minStock:e.minStock,unit:e.unit,expiryDate:e.expiryDate?new Date(e.expiryDate):null,isActive:e.isActive,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}}),r.products++;if(a.sales&&a.sales.length>0)for(let e of a.sales)await v.prisma.sale.create({data:{id:e.id,saleNumber:e.saleNumber,customerId:e.customerId,userId:e.userId,totalAmount:e.totalAmount,discount:e.discount,tax:e.tax,finalAmount:e.finalAmount,paymentMethod:e.paymentMethod,customerName:e.customerName,customerPhone:e.customerPhone,notes:e.notes,status:e.status,isPrinted:e.isPrinted,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),items:{create:e.items.map(e=>({id:e.id,productId:e.productId,quantity:e.quantity,unitPrice:e.unitPrice,discount:e.discount,tax:e.tax,totalPrice:e.totalPrice}))}}}),r.sales++;if(a.returns&&a.returns.length>0)for(let e of a.returns)await v.prisma.return.create({data:{id:e.id,returnNumber:e.returnNumber,saleId:e.saleId,customerId:e.customerId,totalAmount:e.totalAmount,refundMethod:e.refundMethod,reason:e.reason,notes:e.notes,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),items:{create:e.items.map(e=>({id:e.id,productId:e.productId,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,reason:e.reason}))}}}),r.returns++;if(a.purchases&&a.purchases.length>0)for(let e of a.purchases)await v.prisma.purchase.create({data:{id:e.id,purchaseNumber:e.purchaseNumber,supplierId:e.supplierId,totalAmount:e.totalAmount,discount:e.discount,tax:e.tax,finalAmount:e.finalAmount,paidAmount:e.paidAmount,invoiceNumber:e.invoiceNumber,notes:e.notes,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),items:{create:e.items.map(e=>({id:e.id,productId:e.productId,quantity:e.quantity,unitPrice:e.unitPrice,discount:e.discount,tax:e.tax,totalPrice:e.totalPrice}))}}}),r.purchases++;if(a.stockMovements&&a.stockMovements.length>0)for(let e of a.stockMovements)await v.prisma.stockMovement.create({data:{id:e.id,productId:e.productId,type:e.type,quantity:e.quantity,previousStock:e.previousStock,newStock:e.newStock,referenceType:e.referenceType,referenceId:e.referenceId,reason:e.reason,notes:e.notes,createdAt:new Date(e.createdAt)}}),r.stockMovements++;if(a.cashTransactions&&a.cashTransactions.length>0)for(let e of a.cashTransactions)await v.prisma.cashTransaction.create({data:{id:e.id,cashRegisterId:e.cashRegisterId,type:e.type,amount:e.amount,category:e.category,description:e.description,referenceId:e.referenceId,createdAt:new Date(e.createdAt)}}),r.cashTransactions++;return A.NextResponse.json({success:!0,message:"Yedek başarıyla geri yüklendi",restoredCount:r,backupVersion:t.version,backupDate:t.exportDate})}catch(e){return console.error("❌ Yedek geri yükleme hatası:",e),A.NextResponse.json({error:"Yedek geri yüklenemedi",details:e instanceof Error?e.message:"Bilinmeyen hata"},{status:500})}}e.s(["GET",()=>w,"POST",()=>R],59543);var k=e.i(59543);let b=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/backup/route",pathname:"/api/backup",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/Downloads/dark-1/barkod/app/api/backup/route.ts",nextConfigOutput:"standalone",userland:k}),{workAsyncStorage:M,workUnitAsyncStorage:P,serverHooks:I}=b;function E(){return(0,r.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:P})}async function N(e,t,r){b.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let A="/api/backup/route";A=A.replace(/\/index$/,"")||"/";let v=await b.prepare(e,t,{srcPage:A,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:w,params:R,nextConfig:k,parsedUrl:M,isDraftMode:P,prerenderManifest:I,routerServerContext:E,isOnDemandRevalidate:N,revalidateOnlyGenerated:T,resolvedPathname:C,clientReferenceManifest:D,serverActionsManifest:S}=v,q=(0,d.normalizeAppPath)(A),O=!!(I.dynamicRoutes[q]||I.routes[C]),j=async()=>((null==E?void 0:E.render404)?await E.render404(e,t,M,!1):t.end("This page could not be found"),null);if(O&&!P){let e=!!I.routes[C],t=I.dynamicRoutes[q];if(t&&!1===t.fallback&&!e){if(k.experimental.adapterPath)return await j();throw new x.NoFallbackError}}let _=null;!O||b.isDev||P||(_="/index"===(_=C)?"/":_);let H=!0===b.isDev||!O,U=O&&!H;S&&D&&(0,i.setReferenceManifestsSingleton)({page:A,clientReferenceManifest:D,serverActionsManifest:S,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:S})});let $=e.method||"GET",B=(0,s.getTracer)(),F=B.getActiveScopeSpan(),K={params:R,prerenderManifest:I,renderOpts:{experimental:{authInterrupts:!!k.experimental.authInterrupts},cacheComponents:!!k.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:k.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r)=>b.onRequestError(e,t,r,E)},sharedContext:{buildId:w}},L=new c.NodeNextRequest(e),G=new c.NodeNextResponse(t),V=u.NextRequestAdapter.fromNodeNextRequest(L,(0,u.signalFromNodeResponse)(t));try{let i=async e=>b.handle(V,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=B.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==l.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${$} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${$} ${A}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),d=async n=>{var s,d;let c=async({previousCacheEntry:a})=>{try{if(!o&&N&&T&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(n);e.fetchMetrics=K.renderOpts.fetchMetrics;let d=K.renderOpts.pendingWaitUntil;d&&r.waitUntil&&(r.waitUntil(d),d=void 0);let c=K.renderOpts.collectedTags;if(!O)return await (0,m.sendResponse)(L,G,s,K.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);c&&(t[y.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,r=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==a?void 0:a.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:A,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:N})},E),t}},u=await b.handleResponse({req:e,nextConfig:k,cacheKey:_,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:I,isRoutePPREnabled:!1,isOnDemandRevalidate:N,revalidateOnlyGenerated:T,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:o});if(!O)return null;if((null==u||null==(s=u.value)?void 0:s.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(d=u.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",N?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),P&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let l=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&O||l.delete(y.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||l.get("Cache-Control")||l.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,m.sendResponse)(L,G,new Response(u.value.body,{headers:l,status:u.value.status||200})),null};F?await d(F):await B.withPropagatedContext(e.headers,()=>B.trace(l.BaseServerSpan.handleRequest,{spanName:`${$} ${A}`,kind:s.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},d))}catch(t){if(t instanceof x.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:q,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:N})}),O)throw t;return await (0,m.sendResponse)(L,G,new Response(null,{status:500})),null}}e.s(["handler",()=>N,"patchFetch",()=>E,"routeModule",()=>b,"serverHooks",()=>I,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>P],10370)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__37def193._.js.map